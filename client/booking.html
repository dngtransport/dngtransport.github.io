<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Book Your Trip - DNG Transport</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            brand: {
              50: '#f0f7ff',
              100: '#e0efff',
              200: '#bae0ff',
              300: '#7cc8ff',
              400: '#36acff',
              500: '#0c91f1',
              600: '#0074ce',
              700: '#005ca6',
              800: '#004f89',
              900: '#1e3c72',
              950: '#162b56',
            }
          },
          fontFamily: {
            'sans': ['Plus Jakarta Sans', 'system-ui', 'sans-serif'],
          }
        }
      }
    }
  </script>
  <style>
    .form-input {
      transition: all 0.2s ease;
    }

    .form-input:focus {
      transform: translateY(-1px);
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
    }

    .step {
      display: none;
      opacity: 0;
      transform: translateX(20px);
      transition: all 0.3s ease;
    }

    .step.active {
      display: block;
      opacity: 1;
      transform: translateX(0);
      animation: fadeInLeft 0.4s ease forwards;
    }

    .step-indicator {
      position: relative;
    }

    .step-indicator::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 0;
      right: 0;
      height: 2px;
      background: #e5e7eb;
      z-index: 1;
    }

    .step-indicator .step-item {
      position: relative;
      z-index: 2;
      background: white;
    }

    .step-progress {
      position: absolute;
      top: 50%;
      left: 0;
      height: 2px;
      background: linear-gradient(to right, #0074ce, #005ca6);
      transition: width 0.4s ease;
      z-index: 1;
    }

    @keyframes fadeInLeft {
      from {
        opacity: 0;
        transform: translateX(20px);
      }

      to {
        opacity: 1;
        transform: translateX(0);
      }
    }
  </style>
</head>

<body class="bg-gray-50 min-h-screen font-sans">
  <!-- Navigation -->
  <nav class="sticky top-0 z-50 bg-white border-b border-gray-200 shadow-sm">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
      <div class="flex justify-between items-center h-16">
        <!-- Logo -->
        <div class="flex items-center space-x-3">
          <img src="DNG logo.jpg" alt="DNG Transport" class="h-10 w-10 rounded-lg object-cover">
          <div>
            <h1 class="text-xl font-bold text-gray-900">DNG Transport</h1>
            <p class="text-sm text-gray-500">Safe & Reliable</p>
          </div>
        </div>

        <!-- Navigation Links -->
        <div class="hidden md:flex items-center space-x-8">
          <a href="index.html" class="text-gray-600 hover:text-gray-900 font-medium transition-colors duration-200">
            Home
          </a>
          <a href="pricing.html" class="text-gray-600 hover:text-gray-900 font-medium transition-colors duration-200">
            Pricing
          </a>
          <a href="tel:0598106751" class="text-blue-600 hover:text-blue-700 font-medium transition-colors duration-200">
            Contact
          </a>
        </div>

        <!-- Mobile Menu Button -->
        <button id="mobileMenuBtn" class="md:hidden p-2 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors">
          <i data-lucide="menu" class="w-5 h-5"></i>
        </button>
      </div>

      <!-- Mobile Menu -->
      <div id="mobileMenu" class="hidden md:hidden bg-white border-t border-gray-200">
        <div class="px-4 py-4 space-y-2">
          <a href="index.html"
            class="block py-2 text-gray-600 font-medium hover:text-gray-900 transition-colors">Home</a>
          <a href="pricing.html"
            class="block py-2 text-gray-600 font-medium hover:text-gray-900 transition-colors">Pricing</a>
          <a href="tel:0598106751"
            class="block py-2 text-blue-600 font-medium hover:text-blue-700 transition-colors">Contact</a>
        </div>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <main class="pt-8 pb-16">
    <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Header -->
      <div class="text-center mb-8">
        <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-4">Book Your Trip</h1>
        <p class="text-xl text-gray-600 max-w-2xl mx-auto">Follow the simple steps below to secure your seat with DNG
          Transport.</p>
      </div>

      <!-- Step Indicator -->
      <div class="mb-12">
        <div class="step-indicator flex items-center justify-between max-w-3xl mx-auto px-4">
          <div class="step-progress" id="stepProgress" style="width: 0%"></div>

          <div class="step-item flex flex-col items-center" data-step="1">
            <div
              class="w-12 h-12 rounded-full border-2 border-brand-600 bg-brand-600 text-white flex items-center justify-center text-sm font-bold transition-all duration-300"
              id="step1Indicator">
              1
            </div>
            <span class="text-sm text-gray-600 mt-2 hidden sm:block font-medium">Travel Details</span>
          </div>

          <div class="step-item flex flex-col items-center" data-step="2">
            <div
              class="w-12 h-12 rounded-full border-2 border-gray-300 bg-white flex items-center justify-center text-sm font-bold transition-all duration-300"
              id="step2Indicator">
              2
            </div>
            <span class="text-sm text-gray-600 mt-2 hidden sm:block font-medium">Personal Info</span>
          </div>

          <div class="step-item flex flex-col items-center" data-step="3">
            <div
              class="w-12 h-12 rounded-full border-2 border-gray-300 bg-white flex items-center justify-center text-sm font-bold transition-all duration-300"
              id="step3Indicator">
              3
            </div>
            <span class="text-sm text-gray-600 mt-2 hidden sm:block font-medium">Emergency Contact</span>
          </div>

          <div class="step-item flex flex-col items-center" data-step="4">
            <div
              class="w-12 h-12 rounded-full border-2 border-gray-300 bg-white flex items-center justify-center text-sm font-bold transition-all duration-300"
              id="step4Indicator">
              4
            </div>
            <span class="text-sm text-gray-600 mt-2 hidden sm:block font-medium">Review & Submit</span>
          </div>
        </div>
      </div>

      <!-- Booking Form -->
      <div class="bg-white rounded-2xl border border-gray-200 overflow-hidden">
        <!-- Form Header -->
        <div class="bg-gradient-to-r from-brand-600 to-brand-700 text-white px-8 py-6">
          <h2 class="text-2xl font-bold mb-2" id="stepTitle">Travel Details</h2>
          <p class="text-brand-100" id="stepDescription">Select your destination and travel preferences</p>
        </div>

        <!-- Form Content -->
        <form id="bookingForm" class="p-8">
          <!-- Success Message (Hidden by default) -->
          <div id="successMessage" class="hidden bg-green-50 border border-green-200 rounded-xl p-6 mb-6">
            <div class="flex items-center space-x-3">
              <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                <i data-lucide="check" class="w-5 h-5 text-green-600"></i>
              </div>
              <div>
                <h3 class="font-bold text-green-800">Booking Submitted Successfully!</h3>
                <p class="text-green-700">Thank you for choosing DNG Transport. We'll contact you soon to confirm your
                  booking.</p>
              </div>
            </div>
          </div>

          <!-- Error Message (Hidden by default) -->
          <div id="errorMessage" class="hidden bg-red-50 border border-red-200 rounded-xl p-6 mb-6">
            <div class="flex items-center space-x-3">
              <div class="w-8 h-8 bg-red-100 rounded-full flex items-center justify-center">
                <i data-lucide="alert-circle" class="w-5 h-5 text-red-600"></i>
              </div>
              <div>
                <h3 class="font-bold text-red-800">Booking Error</h3>
                <p class="text-red-700" id="errorText">Please check your information and try again.</p>
              </div>
            </div>
          </div>

          <!-- Step 1: Travel Details -->
          <div class="step active" id="step1">
            <div class="space-y-8">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="form-group">
                  <label for="destination" class="block text-sm font-semibold text-gray-700 mb-3">
                    <i data-lucide="map-pin" class="w-5 h-5 inline mr-2 text-brand-600"></i>
                    Where are you going? *
                  </label>
                  <select id="destination" name="destination" required
                    class="form-input w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent outline-none bg-white text-lg">
                    <option value="">Select your destination</option>
                    <!-- Options will be dynamically loaded from pricing.json -->
                  </select>
                  <div class="text-red-500 text-sm mt-2 hidden" id="destinationError">Please select your destination
                  </div>
                </div>

                <div class="form-group">
                  <label for="travelDate" class="block text-sm font-semibold text-gray-700 mb-3">
                    <i data-lucide="calendar" class="w-5 h-5 inline mr-2 text-brand-600"></i>
                    When do you want to travel? *
                  </label>
                  <input type="date" id="travelDate" name="travelDate" required
                    class="form-input w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent outline-none text-lg">
                  <div class="text-red-500 text-sm mt-2 hidden" id="travelDateError">Please select your travel date
                  </div>
                </div>
              </div>

              <!-- Bus Type Selection -->
              <div class="form-group">
                <h3 class="text-lg font-semibold text-gray-900 mb-6 flex items-center">
                  <i data-lucide="bus" class="w-5 h-5 mr-2 text-brand-600"></i>
                  Choose your bus type *
                </h3>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <!-- Sprinter Bus -->
                  <div class="relative">
                    <input type="radio" id="sprinter" name="busType" value="sprinter" class="peer sr-only" required>
                    <label for="sprinter"
                      class="block w-full p-6 border-2 border-gray-200 rounded-xl cursor-pointer hover:border-brand-500 peer-checked:border-brand-500 peer-checked:bg-brand-50 transition-all duration-300 hover:shadow-md">
                      <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                          <div class="w-12 h-12 bg-brand-100 rounded-full flex items-center justify-center">
                            <i data-lucide="bus" class="w-6 h-6 text-brand-600"></i>
                          </div>
                          <div>
                            <h3 class="font-bold text-gray-900 text-lg">Sprinter Bus</h3>
                            <p class="text-sm text-gray-600">Standard comfortable seating</p>
                          </div>
                        </div>
                        <div class="text-right">
                          <div class="text-2xl font-bold text-brand-600" id="sprinterPrice">GHS 0</div>
                          <div class="text-xs text-gray-500">per seat</div>
                        </div>
                      </div>
                    </label>
                  </div>

                  <!-- VIP Bus -->
                  <div class="relative" id="vipBusOption">
                    <input type="radio" id="vip" name="busType" value="vip" class="peer sr-only" disabled>
                    <label for="vip"
                      class="block w-full p-6 border-2 border-gray-200 rounded-xl cursor-not-allowed opacity-50 transition-all duration-300"
                      id="vipLabel">
                      <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-4">
                          <div class="w-12 h-12 bg-brand-100 rounded-full flex items-center justify-center">
                            <i data-lucide="crown" class="w-6 h-6 text-brand-600"></i>
                          </div>
                          <div>
                            <h3 class="font-bold text-gray-900 text-lg">VIP Bus</h3>
                            <p class="text-sm text-gray-600">Premium seating & service</p>
                          </div>
                        </div>
                        <div class="text-right">
                          <div class="text-2xl font-bold text-brand-700" id="vipPrice">Not Available</div>
                          <div class="text-xs text-gray-500">for this route</div>
                        </div>
                      </div>
                    </label>
                  </div>
                </div>
                <div class="text-red-500 text-sm mt-3 hidden" id="busTypeError">Please select a bus type</div>
              </div>

              <!-- Special Requests -->
              <div class="form-group">
                <label for="specialRequests" class="block text-sm font-semibold text-gray-700 mb-3">
                  <i data-lucide="message-square" class="w-5 h-5 inline mr-2 text-brand-600"></i>
                  Any special requests? (Optional)
                </label>
                <textarea id="specialRequests" name="specialRequests" rows="3"
                  class="form-input w-full px-4 py-3 border border-gray-300 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent outline-none resize-none"
                  placeholder="Any special requests, pickup location details, or additional comments..."></textarea>
              </div>
            </div>
          </div>

          <!-- Step 2: Personal Information -->
          <div class="step" id="step2">
            <div class="space-y-8">
              <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div class="form-group">
                  <label for="fullName" class="block text-sm font-semibold text-gray-700 mb-3">
                    <i data-lucide="user" class="w-5 h-5 inline mr-2 text-brand-600"></i>
                    What's your full name? *
                  </label>
                  <input type="text" id="fullName" name="fullName" required
                    class="form-input w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent outline-none text-lg"
                    placeholder="Enter your full name">
                  <div class="text-red-500 text-sm mt-2 hidden" id="fullNameError">Please enter your full name</div>
                </div>

                <div class="form-group">
                  <label for="phoneNumber" class="block text-sm font-semibold text-gray-700 mb-3">
                    <i data-lucide="phone" class="w-5 h-5 inline mr-2 text-brand-600"></i>
                    What's your phone number? *
                  </label>
                  <input type="tel" id="phoneNumber" name="phoneNumber" required
                    class="form-input w-full px-4 py-4 border border-gray-300 rounded-xl focus:ring-2 focus:ring-brand-500 focus:border-transparent outline-none text-lg"
                    placeholder="0XX XXX XXXX" pattern="[0-9]{10}">
                  <div class="text-red-500 text-sm mt-2 hidden" id="phoneNumberError">Please enter a valid 10-digit
                    phone number</div>
                </div>
              </div>

              <!-- Information Note -->
              <div class="bg-blue-50 border border-blue-200 rounded-xl p-6">
                <div class="flex items-start space-x-3">
                  <i data-lucide="info" class="w-6 h-6 text-blue-600 mt-1"></i>
                  <div>
                    <h4 class="font-semibold text-blue-900 text-lg mb-2">Important Information</h4>
                    <p class="text-blue-800">Please ensure your contact information is accurate. We will use this to
                      confirm your booking and provide trip updates.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 3: Emergency Contact -->
          <div class="step" id="step3">
            <div class="space-y-8">
              <div class="bg-amber-50 border border-amber-200 rounded-xl p-8">
                <h3 class="font-bold text-amber-800 mb-4 text-xl flex items-center">
                  <i data-lucide="shield-check" class="w-6 h-6 mr-3"></i>
                  Emergency Contact Information
                </h3>
                <p class="text-amber-700 mb-6">Please provide an emergency contact who can be reached in case of any
                  issues during your travel.</p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div>
                    <label for="emergencyName" class="block text-sm font-semibold text-amber-800 mb-3">Emergency Contact
                      Name</label>
                    <input type="text" id="emergencyName" name="emergencyName"
                      class="w-full px-4 py-3 border border-amber-300 rounded-lg focus:ring-2 focus:ring-brand-400 focus:border-transparent outline-none"
                      placeholder="Full name">
                  </div>
                  <div>
                    <label for="emergencyPhone" class="block text-sm font-semibold text-amber-800 mb-3">Emergency
                      Contact Phone</label>
                    <input type="tel" id="emergencyPhone" name="emergencyPhone"
                      class="w-full px-4 py-3 border border-amber-300 rounded-lg focus:ring-2 focus:ring-brand-400 focus:border-transparent outline-none"
                      placeholder="0XX XXX XXXX">
                  </div>
                </div>

                <div class="mt-4 p-4 bg-amber-100 rounded-lg">
                  <p class="text-amber-700 text-sm flex items-center">
                    <i data-lucide="info" class="w-4 h-4 mr-2"></i>
                    This information is optional but strongly recommended for your safety during travel.
                  </p>
                </div>
              </div>
            </div>
          </div>

          <!-- Step 4: Review & Submit -->
          <div class="step" id="step4">
            <div class="space-y-8">
              <!-- Booking Summary -->
              <div class="bg-gray-50 rounded-xl p-8">
                <h3 class="text-2xl font-bold text-gray-900 mb-6 flex items-center">
                  <i data-lucide="clipboard-check" class="w-6 h-6 mr-3 text-brand-600"></i>
                  Review Your Booking
                </h3>

                <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                  <div>
                    <h4 class="font-semibold text-gray-700 mb-4 text-lg">🚌 Travel Details</h4>
                    <div class="space-y-3">
                      <div class="flex justify-between py-2 border-b border-gray-200">
                        <span class="text-gray-600">Destination:</span>
                        <span class="font-semibold" id="summaryDestination">-</span>
                      </div>
                      <div class="flex justify-between py-2 border-b border-gray-200">
                        <span class="text-gray-600">Travel Date:</span>
                        <span class="font-semibold" id="summaryDate">-</span>
                      </div>
                      <div class="flex justify-between py-2 border-b border-gray-200">
                        <span class="text-gray-600">Bus Type:</span>
                        <span class="font-semibold" id="summaryBusType">-</span>
                      </div>
                      <div class="flex justify-between py-3 bg-brand-50 px-4 rounded-lg mt-4">
                        <span class="text-gray-700 font-medium">Total Price:</span>
                        <span class="font-bold text-brand-600 text-2xl" id="summaryPrice">GHS 0</span>
                      </div>
                    </div>
                  </div>

                  <div>
                    <h4 class="font-semibold text-gray-700 mb-4 text-lg">👤 Passenger Information</h4>
                    <div class="space-y-3">
                      <div class="flex justify-between py-2 border-b border-gray-200">
                        <span class="text-gray-600">Name:</span>
                        <span class="font-semibold" id="summaryName">-</span>
                      </div>
                      <div class="flex justify-between py-2 border-b border-gray-200">
                        <span class="text-gray-600">Phone:</span>
                        <span class="font-semibold" id="summaryPhone">-</span>
                      </div>
                      <div class="flex justify-between py-2 border-b border-gray-200">
                        <span class="text-gray-600">Emergency Contact:</span>
                        <span class="font-semibold" id="summaryEmergency">-</span>
                      </div>
                      <div class="flex justify-between py-2 border-b border-gray-200">
                        <span class="text-gray-600">Special Requests:</span>
                        <span class="font-semibold" id="summaryRequests">-</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Terms and Conditions -->
              <div class="form-group">
                <div class="bg-white border border-gray-200 rounded-xl p-6">
                  <div class="flex items-start space-x-4">
                    <input type="checkbox" id="termsAccepted" name="termsAccepted" required
                      class="mt-1 w-5 h-5 text-brand-600 border-gray-300 rounded focus:ring-2 focus:ring-brand-500">
                    <label for="termsAccepted" class="text-gray-700 leading-relaxed">
                      <span class="font-semibold">I agree to the terms and conditions</span> of DNG Transport. I
                      understand that bookings are subject to availability and I will be contacted for confirmation. *
                    </label>
                  </div>
                  <div class="text-red-500 text-sm mt-2 hidden" id="termsError">Please accept the terms and conditions
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Navigation Buttons -->
          <div class="flex justify-between items-center mt-12 pt-8 border-t border-gray-200">
            <button type="button" id="prevBtn"
              class="hidden px-8 py-3 bg-gray-100 text-gray-700 rounded-xl font-semibold hover:bg-gray-200 transition-colors flex items-center space-x-2">
              <i data-lucide="arrow-left" class="w-5 h-5"></i>
              <span>Previous</span>
            </button>

            <button type="button" id="nextBtn"
              class="ml-auto px-8 py-4 bg-brand-600 text-white rounded-xl font-semibold hover:bg-brand-700 transition-colors flex items-center space-x-2 text-lg">
              <span>Continue</span>
              <i data-lucide="arrow-right" class="w-5 h-5"></i>
            </button>

            <button type="submit" id="submitBtn"
              class="hidden ml-auto px-8 py-4 bg-green-600 text-white rounded-xl font-semibold hover:bg-green-700 transition-colors flex items-center space-x-2 text-lg">
              <i data-lucide="send" class="w-5 h-5"></i>
              <span>Submit Booking</span>
            </button>
          </div>

          <!-- Loading State -->
          <div id="loadingState" class="hidden text-center py-8">
            <div class="inline-flex items-center space-x-3 text-brand-600">
              <div class="animate-spin rounded-full h-8 w-8 border-b-2 border-brand-600"></div>
              <span class="font-semibold text-lg">Submitting your booking...</span>
            </div>
          </div>
        </form>
      </div>

      <!-- Contact Information -->
      <div class="mt-12 bg-white rounded-xl shadow-sm border border-gray-200 p-6">
        <div class="text-center">
          <h3 class="text-xl font-bold text-gray-900 mb-4">Need Help? Contact Us</h3>
          <div
            class="flex flex-col sm:flex-row items-center justify-center space-y-3 sm:space-y-0 sm:space-x-8 text-gray-600">
            <a href="tel:0598106751"
              class="flex items-center space-x-2 hover:text-brand-600 transition-colors font-medium">
              <div class="w-8 h-8 bg-brand-100 rounded-full flex items-center justify-center">
                <i data-lucide="phone" class="w-4 h-4 text-brand-600"></i>
              </div>
              <span>0598106751</span>
            </a>
            <a href="tel:0595223640"
              class="flex items-center space-x-2 hover:text-brand-600 transition-colors font-medium">
              <div class="w-8 h-8 bg-brand-100 rounded-full flex items-center justify-center">
                <i data-lucide="phone" class="w-4 h-4 text-brand-600"></i>
              </div>
              <span>0595223640</span>
            </a>
            <a href="tel:0246962314"
              class="flex items-center space-x-2 hover:text-brand-600 transition-colors font-medium">
              <div class="w-8 h-8 bg-brand-100 rounded-full flex items-center justify-center">
                <i data-lucide="phone" class="w-4 h-4 text-brand-600"></i>
              </div>
              <span>0246962314</span>
            </a>
          </div>
        </div>
      </div>
    </div>
  </main>

  <script>
    // Initialize Lucide icons
    lucide.createIcons();

    // Global variables
    let currentStep = 1;
    const totalSteps = 4;
    let pricingData = {};

    // Step data
    const stepData = {
      1: {
        title: "Travel Details",
        description: "Select your destination and travel preferences"
      },
      2: {
        title: "Personal Information",
        description: "Tell us about yourself"
      },
      3: {
        title: "Emergency Contact",
        description: "Safety first - provide emergency contact details"
      },
      4: {
        title: "Review & Submit",
        description: "Review your booking details and confirm"
      }
    };

    // DOM elements
    const form = document.getElementById('bookingForm');
    const destinationSelect = document.getElementById('destination');
    const sprinterPriceEl = document.getElementById('sprinterPrice');
    const vipPriceEl = document.getElementById('vipPrice');
    const vipBusOption = document.getElementById('vipBusOption');
    const vipRadio = document.getElementById('vip');
    const vipLabel = document.getElementById('vipLabel');
    const submitBtn = document.getElementById('submitBtn');
    const nextBtn = document.getElementById('nextBtn');
    const prevBtn = document.getElementById('prevBtn');
    const loadingState = document.getElementById('loadingState');
    const successMessage = document.getElementById('successMessage');
    const errorMessage = document.getElementById('errorMessage');
    const mobileMenuBtn = document.getElementById('mobileMenuBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    const stepTitle = document.getElementById('stepTitle');
    const stepDescription = document.getElementById('stepDescription');
    const stepProgress = document.getElementById('stepProgress');

    // Google Apps Script Web App URL - DNG Transport Booking System
    const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbw8v2c1OFzepBk6Ue2hxqAuHULvLZLW6ok_7FE-gXnmCdA51mscFaNqRF1sAeYlSEhS/exec';

    // Initialize
    document.getElementById('travelDate').min = new Date().toISOString().split('T')[0];
    loadPricingData();

    // Load pricing data from JSON
    async function loadPricingData() {
      try {
        const response = await fetch('pricing.json');
        const data = await response.json();

        // Transform data for easier access
        data.destinations.forEach(dest => {
          pricingData[dest.destination] = {
            sprinter: dest.sprinterBus,
            vip: dest.vipAvailable ? dest.vipBus : false,
            region: dest.region,
            duration: dest.duration
          };
        });

        // Populate destination dropdown
        populateDestinations(data.destinations);

        // Check for pre-selected destination
        const urlParams = new URLSearchParams(window.location.search);
        const preSelectedDestination = urlParams.get('destination');

        if (preSelectedDestination) {
          destinationSelect.value = preSelectedDestination;
          updateBusOptions();
        }

      } catch (error) {
        console.error('Error loading pricing data:', error);
        // Fallback to hardcoded data if JSON fails to load
        pricingData = {
          'Kumasi': { sprinter: 117, vip: 150 },
          'Tema': { sprinter: 91, vip: false },
          'Ashaiman': { sprinter: 91, vip: false },
          'Madina/Adenta': { sprinter: 86, vip: false },
          'Kaneshie/Circle': { sprinter: 77, vip: 117 },
          'Kasoa': { sprinter: 72, vip: false },
          'Koforidua': { sprinter: 152, vip: false },
          'Akim Oda': { sprinter: 86, vip: false },
          'Pokuase/Amasaman': { sprinter: 81, vip: false }
        };
        populateFallbackDestinations();
      }
    }

    // Populate destination dropdown from JSON data
    function populateDestinations(destinations) {
      const select = document.getElementById('destination');

      // Clear existing options (except the first placeholder)
      while (select.children.length > 1) {
        select.removeChild(select.lastChild);
      }

      // Sort destinations alphabetically
      destinations.sort((a, b) => a.destination.localeCompare(b.destination));

      // Add options
      destinations.forEach(dest => {
        const option = document.createElement('option');
        option.value = dest.destination;
        option.textContent = dest.destination;
        option.dataset.region = dest.region;
        option.dataset.duration = dest.duration;
        select.appendChild(option);
      });
    }

    // Fallback function for hardcoded destinations
    function populateFallbackDestinations() {
      const destinations = Object.keys(pricingData);
      const select = document.getElementById('destination');

      destinations.forEach(dest => {
        const option = document.createElement('option');
        option.value = dest;
        option.textContent = dest;
        select.appendChild(option);
      });
    }

    // Mobile menu toggle
    mobileMenuBtn.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
      const icon = mobileMenuBtn.querySelector('i');
      if (mobileMenu.classList.contains('hidden')) {
        icon.setAttribute('data-lucide', 'menu');
      } else {
        icon.setAttribute('data-lucide', 'x');
      }
      lucide.createIcons();
    });

    // Update step display
    function updateStep(step) {
      // Hide all steps
      document.querySelectorAll('.step').forEach(s => s.classList.remove('active'));

      // Show current step
      document.getElementById(`step${step}`).classList.add('active');

      // Update step indicators
      for (let i = 1; i <= totalSteps; i++) {
        const indicator = document.getElementById(`step${i}Indicator`);
        if (i < step) {
          // Completed steps
          indicator.className = 'w-12 h-12 rounded-full border-2 border-brand-600 bg-brand-600 text-white flex items-center justify-center text-sm font-bold transition-all duration-300';
          indicator.innerHTML = '<i data-lucide="check" class="w-5 h-5"></i>';
        } else if (i === step) {
          // Current step
          indicator.className = 'w-12 h-12 rounded-full border-2 border-brand-600 bg-brand-600 text-white flex items-center justify-center text-sm font-bold transition-all duration-300';
          indicator.textContent = i;
        } else {
          // Future steps
          indicator.className = 'w-12 h-12 rounded-full border-2 border-gray-300 bg-white flex items-center justify-center text-sm font-bold transition-all duration-300';
          indicator.textContent = i;
        }
      }

      // Update progress bar
      const progressWidth = ((step - 1) / (totalSteps - 1)) * 100;
      stepProgress.style.width = `${progressWidth}%`;

      // Update title and description
      stepTitle.textContent = stepData[step].title;
      stepDescription.textContent = stepData[step].description;

      // Update navigation buttons
      prevBtn.classList.toggle('hidden', step === 1);
      nextBtn.classList.toggle('hidden', step === totalSteps);
      submitBtn.classList.toggle('hidden', step !== totalSteps);

      // Update continue button text
      if (step < totalSteps) {
        nextBtn.querySelector('span').textContent = step === 3 ? 'Review Booking' : 'Continue';
      }

      // Update icons
      lucide.createIcons();
    }

    // Step navigation
    nextBtn.addEventListener('click', () => {
      if (validateCurrentStep()) {
        if (currentStep === 3) {
          updateSummary();
        }
        currentStep++;
        updateStep(currentStep);
      }
    });

    prevBtn.addEventListener('click', () => {
      currentStep--;
      updateStep(currentStep);
    });

    // Validate current step
    function validateCurrentStep() {
      const errors = {};
      let isValid = true;

      // Clear previous errors
      document.querySelectorAll('.text-red-500').forEach(el => el.classList.add('hidden'));

      if (currentStep === 1) {
        // Validate destination
        const destination = document.getElementById('destination').value;
        if (!destination) {
          errors.destination = 'Please select your destination';
          isValid = false;
        }

        // Validate travel date
        const travelDate = document.getElementById('travelDate').value;
        if (!travelDate) {
          errors.travelDate = 'Please select your travel date';
          isValid = false;
        } else {
          const selectedDate = new Date(travelDate);
          const today = new Date();
          today.setHours(0, 0, 0, 0);
          if (selectedDate < today) {
            errors.travelDate = 'Travel date cannot be in the past';
            isValid = false;
          }
        }

        // Validate bus type
        const busType = document.querySelector('input[name="busType"]:checked');
        if (!busType) {
          errors.busType = 'Please select a bus type';
          isValid = false;
        }
      } else if (currentStep === 2) {
        // Validate full name
        const fullName = document.getElementById('fullName').value.trim();
        if (!fullName) {
          errors.fullName = 'Please enter your full name';
          isValid = false;
        }

        // Validate phone number
        const phoneNumber = document.getElementById('phoneNumber').value.trim();
        const phoneRegex = /^[0-9]{10}$/;
        if (!phoneNumber || !phoneRegex.test(phoneNumber)) {
          errors.phoneNumber = 'Please enter a valid 10-digit phone number';
          isValid = false;
        }
      } else if (currentStep === 4) {
        // Validate terms acceptance
        const termsAccepted = document.getElementById('termsAccepted').checked;
        if (!termsAccepted) {
          errors.terms = 'Please accept the terms and conditions';
          isValid = false;
        }
      }

      // Display errors
      Object.keys(errors).forEach(field => {
        const errorEl = document.getElementById(field === 'terms' ? 'termsError' : `${field}Error`);
        if (errorEl) {
          errorEl.textContent = errors[field];
          errorEl.classList.remove('hidden');
        }
      });

      return isValid;
    }

    // Update summary
    function updateSummary() {
      const destination = document.getElementById('destination').value;
      const travelDate = document.getElementById('travelDate').value;
      const busType = document.querySelector('input[name="busType"]:checked')?.value;
      const fullName = document.getElementById('fullName').value;
      const phoneNumber = document.getElementById('phoneNumber').value;
      const emergencyName = document.getElementById('emergencyName').value;
      const emergencyPhone = document.getElementById('emergencyPhone').value;
      const specialRequests = document.getElementById('specialRequests').value;

      document.getElementById('summaryDestination').textContent = destination || '-';
      document.getElementById('summaryDate').textContent = travelDate ? new Date(travelDate).toLocaleDateString() : '-';
      document.getElementById('summaryBusType').textContent = busType === 'vip' ? 'VIP Bus' : 'Sprinter Bus';
      document.getElementById('summaryName').textContent = fullName || '-';
      document.getElementById('summaryPhone').textContent = phoneNumber || '-';
      document.getElementById('summaryEmergency').textContent =
        emergencyName ? `${emergencyName} (${emergencyPhone || 'No phone'})` : 'Not provided';
      document.getElementById('summaryRequests').textContent = specialRequests || 'None';

      if (pricingData[destination] && busType) {
        const price = pricingData[destination][busType];
        document.getElementById('summaryPrice').textContent = `GHS ${price}`;
      }
    }

    // Destination change handler
    destinationSelect.addEventListener('change', updateBusOptions);

    function updateBusOptions() {
      const selectedDestination = destinationSelect.value;

      if (selectedDestination && pricingData[selectedDestination]) {
        const pricing = pricingData[selectedDestination];

        // Update Sprinter price
        sprinterPriceEl.textContent = `GHS ${pricing.sprinter}`;

        // Update VIP option
        if (pricing.vip) {
          // VIP available
          vipPriceEl.textContent = `GHS ${pricing.vip}`;
          vipPriceEl.nextElementSibling.textContent = 'per seat';
          vipRadio.disabled = false;
          vipLabel.classList.remove('cursor-not-allowed', 'opacity-50');
          vipLabel.classList.add('cursor-pointer', 'hover:border-brand-500', 'peer-checked:border-brand-500', 'peer-checked:bg-brand-50', 'hover:shadow-md');
        } else {
          // VIP not available
          vipPriceEl.textContent = 'Not Available';
          vipPriceEl.nextElementSibling.textContent = 'for this route';
          vipRadio.disabled = true;
          vipRadio.checked = false;
          vipLabel.classList.add('cursor-not-allowed', 'opacity-50');
          vipLabel.classList.remove('cursor-pointer', 'hover:border-brand-500', 'peer-checked:border-brand-500', 'peer-checked:bg-brand-50', 'hover:shadow-md');

          // Auto-select Sprinter if VIP was selected
          document.getElementById('sprinter').checked = true;
        }
      } else {
        // Reset prices
        sprinterPriceEl.textContent = 'GHS 0';
        vipPriceEl.textContent = 'Not Available';
        vipPriceEl.nextElementSibling.textContent = 'for this route';
        vipRadio.disabled = true;
        vipRadio.checked = false;
        vipLabel.classList.add('cursor-not-allowed', 'opacity-50');
        vipLabel.classList.remove('cursor-pointer', 'hover:border-brand-500', 'peer-checked:border-brand-500', 'peer-checked:bg-brand-50', 'hover:shadow-md');
      }
    }

    // Form submission
    form.addEventListener('submit', async (e) => {
      e.preventDefault();

      if (!validateCurrentStep()) {
        return;
      }

      // Show loading state
      submitBtn.style.display = 'none';
      prevBtn.style.display = 'none';
      loadingState.classList.remove('hidden');

      // Prepare form data
      const formData = new FormData(form);
      const data = Object.fromEntries(formData.entries());

      // Add pricing information
      const destination = data.destination;
      const busType = data.busType;
      if (pricingData[destination]) {
        data.price = pricingData[destination][busType];
        data.currency = 'GHS';
      }

      // Add timestamp
      data.timestamp = new Date().toISOString();

      try {
        // Submit to Google Sheets via Google Apps Script
        const response = await fetch(GOOGLE_SCRIPT_URL, {
          method: 'POST',
          redirect: 'follow',
          headers: {
            "Content-Type": "text/plain;charset=utf-8",
          },
          body: JSON.stringify(data)
        });

        if (!response.ok) {
          throw new Error('Network response was not ok');
        }

        const result = await response.json();

        if (result.success) {
          showSuccess(result.bookingReference);
        } else {
          throw new Error(result.error || 'Submission failed');
        }

      } catch (error) {
        console.error('Error submitting form:', error);
        showError('There was an error submitting your booking. Please try again or contact us directly.');
      } finally {
        // Hide loading state
        loadingState.classList.add('hidden');
      }
    });

    function showSuccess(bookingReference) {
      // Update success message with booking reference if provided
      if (bookingReference) {
        const successContent = document.querySelector('#successMessage div div:last-child');
        successContent.innerHTML = `
          <h3 class="font-bold text-green-800">Booking Submitted Successfully!</h3>
          <p class="text-green-700">Your booking reference is: <strong class="font-bold text-green-900">${bookingReference}</strong></p>
          <p class="text-green-600 text-sm mt-2">Thank you for choosing DNG Transport. We'll contact you soon to confirm your booking.</p>
        `;
      }

      successMessage.classList.remove('hidden');
      form.reset();
      updateBusOptions();
      currentStep = 1;
      updateStep(currentStep);
      // Scroll to success message
      successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    function showError(message) {
      document.getElementById('errorText').textContent = message;
      errorMessage.classList.remove('hidden');
      submitBtn.style.display = 'flex';
      prevBtn.style.display = 'flex';
      // Scroll to error message
      errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
    }

    // Real-time validation
    document.getElementById('fullName').addEventListener('input', (e) => {
      if (e.target.value.trim()) {
        document.getElementById('fullNameError').classList.add('hidden');
      }
    });

    document.getElementById('phoneNumber').addEventListener('input', (e) => {
      const phoneRegex = /^[0-9]{10}$/;
      if (phoneRegex.test(e.target.value.trim())) {
        document.getElementById('phoneNumberError').classList.add('hidden');
      }
    });

    document.getElementById('destination').addEventListener('change', (e) => {
      if (e.target.value) {
        document.getElementById('destinationError').classList.add('hidden');
      }
    });

    document.getElementById('travelDate').addEventListener('change', (e) => {
      if (e.target.value) {
        document.getElementById('travelDateError').classList.add('hidden');
      }
    });

    document.querySelectorAll('input[name="busType"]').forEach(radio => {
      radio.addEventListener('change', () => {
        document.getElementById('busTypeError').classList.add('hidden');
      });
    });

    document.getElementById('termsAccepted').addEventListener('change', (e) => {
      if (e.target.checked) {
        document.getElementById('termsError').classList.add('hidden');
      }
    });
  </script>
</body>

</html>